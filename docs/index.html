<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick and Simple Tools for Training and Testing of Tree-based Models • forester</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- dalexverse --><link href="dalexverse.css" rel="stylesheet">
<link href="dalexverse-2.css" rel="stylesheet">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Quick and Simple Tools for Training and Testing of Tree-based Models">
<meta property="og:description" content="Extendable set of tools to facilitate training, tuning and testing 
    of tree-based models.
    Designed to quickly produce a good baseline model, that can be further tuned manually.
    The primary value generated by the forester package is to promptly build a baseline for other, 
    more complex models. 
    This package extends the prototype developed by the https://github.com/ModelOriented/forester project.
    Results are explainers consistent with DrWhy universe.
    Explanations from the DALEX library can be used without any further preparation.
    As tree models are trained, the explanations developed by the TreeShap method can be used. 
    So resulting explanations have a quick feedback loop that can leverage Navigated Data Exploration.">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- google analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="index.html">forester</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy" class="external-link">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/" class="external-link">MI^2 DataLab</a> </span>
          <span class="version version-default">1.0.0</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Tutorial.html">forester tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ModelOriented/forester/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level2">
<h2 id="forester-automated-partner-for-planting-transparent-tree-based-models">
<strong>forester: automated partner for planting transparent tree-based models</strong><a class="anchor" aria-label="anchor" href="#forester-automated-partner-for-planting-transparent-tree-based-models"></a>
</h2>
<p>A significant amount of time is spent on building models with high performance. Selecting the appropriate model structures, optimizing hyperparameters and explainability are only part of the process of creating a machine learning-based solution. Despite the wide range of structures considered, tree-based models are champions in competitions or hackathons. So, aren’t tree-based models enough?</p>
<p>They definitely are and that’s why we want to fully automate the machine learning process for them, so everyone will be able to use the computational power of the trees.</p>
</div>
<div class="section level2">
<h2 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h2>
<p>This package is created inside the MI2 Data Lab as both scientific research and Bachelor thesis by:</p>
<ul>
<li>Adrianna Grudzień, Warsaw University of Technology, Bachelor Degree student</li>
<li>Hubert Ruczyński, Warsaw University of Technology, Bachelor Degree student</li>
<li>Patryk Słowakiewicz, Warsaw University of Technology, Bachelor Degree student</li>
<li>MSc Anna Kozak, Warsaw University of Technology, project co-ordinator and supervisor</li>
<li>PhD. Przemysław Biecek, Warsaw University of Technology, auxiliary supervisor</li>
</ul>
<p>The previous version of forester was created by:</p>
<ul>
<li>Hoang Thien Ly, Warsaw University of Technology, Bachelor Degree</li>
<li>Szymon Szmajdziński, Warsaw University of Technology, Bachelor Degree student</li>
</ul>
</div>
<div class="section level2">
<h2 id="what-is-the-forester">What is the forester?<a class="anchor" aria-label="anchor" href="#what-is-the-forester"></a>
</h2>
<p>The forester is an autoML tool that wraps up all ML processes into a single <code><a href="reference/train.html">train()</a></code> function, which includes:</p>
<ul>
<li>Rendering a brief data check report,</li>
<li>Preprocessing the initial dataset enough for models to be trained,</li>
<li>Training 5 tree-based models with default parameters, random search and Bayesian optimization,</li>
<li>Evaluating them and providing a ranked list.</li>
</ul>
<p>However, that’s not everything that the forester has to offer. Via additional functions, the user can easily explain created models with the usage of DALEX or generate one of the predefined reports including:</p>
<ul>
<li>Data Check report - information about the dataset: correlation, outliers, missing values, …</li>
<li>Detailed information about best models (parameters)</li>
<li>Visualizations comparing the best models</li>
<li>Explanations of the aforementioned models</li>
</ul>
</div>
<div class="section level2">
<h2 id="for-whom-is-this-package-created">For whom is this package created?<a class="anchor" aria-label="anchor" href="#for-whom-is-this-package-created"></a>
</h2>
<p>The forester aims for both experienced and inexperienced users. The major advantage of this package is simple syntax and the ability to train plenty of highly effective models in just a few lines. It is really handy for the newcomers, because they don’t have to fully understand what stays behind the training process and they have to read only short documentation to train their first, yet highly effective models.</p>
<p>More experienced users are handed an easy-to-use tool that might be used for preparing high-quality baseline models for comparison with more advanced methods or a set of starting parameters for more thorough optimization.</p>
</div>
<div class="section level2">
<h2 id="preprocessing-and-data-preparation">Preprocessing and data preparation<a class="anchor" aria-label="anchor" href="#preprocessing-and-data-preparation"></a>
</h2>
<p>The first and probably most important step in the forester pipeline is preprocessing. It is so crucial because it enables the user to build models on all types of datasets, regardless of the data quality. This pipeline consists of:</p>
<ul>
<li>Guessing the type of ml task</li>
<li>Rendering a check data report</li>
<li>Preprocessing</li>
<li>Balancing and splitting the dataset</li>
<li>Preparation for different models</li>
</ul>
<div class="section level3">
<h3 id="guessing-type-of-ml-task">Guessing type of ml task<a class="anchor" aria-label="anchor" href="#guessing-type-of-ml-task"></a>
</h3>
<p>The first point of the pipeline determines which type of ml task are we facing via the data analysis of the target column. For now supported tasks are binary classification and regression, however, in the future support for multilabel classification will be provided.</p>
</div>
<div class="section level3">
<h3 id="data-check-report">Data Check report<a class="anchor" aria-label="anchor" href="#data-check-report"></a>
</h3>
<p>The forester is designed for training models on data of even the lowest quality, however, in data science, we know that with poor quality input we will get poor output. That’s why to counter this issue we provide a data check report, which prints out issues present in our data. The report contains:</p>
<ul>
<li>Basic information about the dataset: number of observations, columns, their names and which one is a target value</li>
<li>Information if there are static columns (with at least 99% same values)</li>
<li>Information if there are duplicate columns</li>
<li>Information about missing values in predictors and target</li>
<li>Information about dimensionality issues (more features than observations, too big dimensionality for tree-based models)</li>
<li>Information about strongly correlated categorical (Crammer’s V) and numerical (Pearson) values</li>
<li>Information about outliers detected by 3 methods: mean standard deviation, median absolute deviation and inter quantile range</li>
<li>Information about balance in target column (even distribution in quantiles for regression task)</li>
</ul>
<p>With such a detailed report the user is aware of data quality and thus the quality of the models. Advanced users can address those issues if they want better-performing models.</p>
</div>
<div class="section level3">
<h3 id="preprocessing">Preprocessing<a class="anchor" aria-label="anchor" href="#preprocessing"></a>
</h3>
<p>However not all of the aforementioned problems we can pass to the training phase, that’s why we had to address 3 of them in preprocessing stage. We always remove static columns, because the decision tree cannot grow with such data. We also binarize the target column into numerical values for unified predictions. In the end, we have to manage missing values. To do that, we remove columns with more than 50% missing values and impute the rest via the MICE algorithm (Multivariate Imputation by Chained Equations).</p>
</div>
<div class="section level3">
<h3 id="balanced-data-splits">Balanced data splits<a class="anchor" aria-label="anchor" href="#balanced-data-splits"></a>
</h3>
<p>As the main task of the forester is training and predicting ml models we have to divide given datasets into train, test and validation subsets. To affirm the best possible results, we assure that given sets will be balanced in terms of target values.</p>
</div>
<div class="section level3">
<h3 id="data-preparation-for-different-models">Data preparation for different models<a class="anchor" aria-label="anchor" href="#data-preparation-for-different-models"></a>
</h3>
<p>There are plenty of problems regarding different models because they need different input data types for training and predicting. Moreover, some of them (e.g. xgboost) needs only numerical data (which means one hot encoding is needed) or factors for all possible values in both training and testing dataset. To face these issues we had to add group ‘other’ for every categorical value and map all level values into the training dataset, so it can make all possible predictions. Moreover, we create separate datasets for every model type, which enables us to train them and make predictions easily.</p>
</div>
</div>
<div class="section level2">
<h2 id="training-process">Training process<a class="anchor" aria-label="anchor" href="#training-process"></a>
</h2>
<p>After the data preparation phase, the forester conducts a training process on the training subset, which consists of creating 5 models:</p>
<ul>
<li>Random Forest (package: ranger)</li>
<li>XGBoost (xgboost)</li>
<li>Decision Tree (partykit)</li>
<li>LightGBM (lightgbm)</li>
<li>CatBoost (catboost)</li>
</ul>
<p>These models are later trained with: default parameters, random search parameters, and Bayesian Optimization parameters, so in the end at least 15 models are trained. After the training phase, we are making predictions on the test subset and evaluate every model to make a ranked list of all models with calculated metrics (regression: MSE, R2, MAD; binary classification: F1, accuracy AUC), where they are sorted from the best one to the worst, by selected metric (MSE, AUC). The user can easily retrieve the parameters of the best models.</p>
</div>
<div class="section level2">
<h2 id="auto-generated-reports">Auto-generated reports<a class="anchor" aria-label="anchor" href="#auto-generated-reports"></a>
</h2>
<p>One of the extensional features which are great is an option to automatically generate reports from the training process. At this point there is only one predefined report which consists of:</p>
<ul>
<li>Data Check report</li>
<li>Training report: Metrics for best models</li>
<li>Radar plot comparing the best models by their metrics</li>
<li>Train vs test plot, to control overfitting</li>
<li>Training parameters</li>
<li>Confusion matrix</li>
<li>Boxplots for residuals</li>
<li>Feature importance plot for the best model</li>
</ul>
<p>In the end, we want to create more report templates, with the current one set as a default one. There might be reports more focused on: EDA, visualization of the training process, outcomes of the model with metrics and Explainable Artificial Intelligence (XAI).</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ModelOriented/forester/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ModelOriented/forester/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing forester</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Anna Kozak <br><small class="roles"> Author, maintainer </small>  </li>
<li>Hubert Ruczyński <br><small class="roles"> Author </small>  </li>
<li>Patryk Słowakiewicz <br><small class="roles"> Author </small>  </li>
<li>Adrianna Grudzień <br><small class="roles"> Author </small>  </li>
<li>Przemysław Biecek <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by .</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
